%% Author: Lu, Chia-Feng 2013.12.19
clear, close all
clc

%% input data
X=[29,32,36,44,40,34,30,33,32,27,38,43,33,32,35,44,51,31,33,32,35,44,51,31,33,31,29,32,36,44,40,34,30,33,32,27,38,43,33,32,35,33,31,29,32,36,44,40,34,30,33,32,27,38,43,44,51,31,32,30,33,31,32,30,31,31,32,30,31,...
   34,41,36,38,35,37,44,36,28,23,29,31,37,34,30,48,37,37,37,34,30,48,37,37,33,35,34,41,36,38,35,37,44,36,28,23,29,31,37,34,30,33,35,34,41,36,38,35,37,44,36,28,23,29,31,48,37,37,34,44,33,35,34,44,37,37,34,44,37,... 
   38,35,43,47,40,38,40,34,51,41,30,40,50,37,43,31,40,53,50,37,43,31,40,53,41,35,38,35,43,47,40,38,40,34,51,41,30,40,50,37,43,41,35,38,35,43,47,40,38,40,34,51,41,30,40,31,40,53,37,40,41,35,37,40,53,53,37,40,53];
% 喜歡程度量表

factor1=[ones(1,69) ones(1,69)*2 ones(1,69)*3]; % 3種壁紙顏色
factor2=[1:69 1:69 1:69]; % 69位受試者

dim=1;   % only the 1st factor need to be tested by post-hoc

%% perform two way ANOVA using nanova 
[p,table,Stats]=anovan(X,{factor1 factor2},'random',2)  % perform two-way ANOVA

figure,
[comp,m] = multcompare(Stats,'ctype','scheffe','dimension',dim)  % post-hoc on the 2nd factor


