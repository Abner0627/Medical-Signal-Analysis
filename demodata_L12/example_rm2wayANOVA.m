%% Author: Lu, Chia-Feng 2013.12.19
clear, close all
clc

%% input data
X=[3.3,3.2,3.5,4.4,3,3.3,3.2,2.7,3.8,4.3,2.9,3.2,3.6,4.4,4,3.4,3.3,3.2,3.5,4.4,5.1,3.1,5.1,3.1,3.3,3.1,2.9,3.2,3.6,4.4,4,3.4,3,3.2,...
   3.7,3.4,3,4.8,4.4,3.6,2.8,2.3,2.9,3.1,3.4,4.1,3.6,3.8,3.5,3.7,3.7,3.4,3,4.8,3.7,3.7,3.7,3.7,3.3,3.5,3.4,4.1,3.6,3.8,3.5,3.7,4.4,2.8,...
   4,2.7,3.3,2.1,3,2.4,4.1,3.1,2,3,2.8,2.5,3.3,3.7,3,2.8,4,2.7,3.3,2.1,3,4.3,3,4.3,3.1,2.5,2.8,2.5,3.3,3.7,3,2.8,3,4.1,...
   3.1,2.9,3.2,3.6,4.4,4,3.4,3,3.3,3.2,2.7,2.7,3.8,4.3,3.3,3.2,3.5,3.3,3.8,4.3,4.4,5.1,3.1,3.2,3,3.3,3.1,3.2,3,3.1,3.1,3.2,3,3.1,...
   3.5,3.4,4.1,3.6,3.8,3.5,3.7,4.4,3.6,2.8,2.3,2.3,2.9,3.1,3.7,3.4,3,3.3,2.9,3.1,4.8,3.7,3.7,3.4,4.4,3.3,3.5,3.4,4.4,3.7,3.7,3.4,4.4,3.7,...
   2.5,2.8,2.5,3.3,3.7,3,2.8,3,2.4,4.1,3.1,3.1,2,3,4,2.7,3.3,3.1,2,3,2.1,3,4.3,2.7,3,3.1,2.5,2.7,3,4.3,4.3,2.7,3,4.3;];
% 對不同顏色光的反應時間

factor1=[ones(1,34) ones(1,34)*2 ones(1,34)*3 ones(1,34) ones(1,34)*2 ones(1,34)*3]; % 3種顏色光刺激
factor2=[ones(1,34) ones(1,34) ones(1,34) ones(1,34)*2 ones(1,34)*2 ones(1,34)*2]; % 左、右眼
factor3=[1:34 1:34 1:34 1:34 1:34 1:34]; % 34位受試者

dim=1;   % only the 1st factor need to be tested by post-hoc

%% perform two way ANOVA using nanova 
[p,table,Stats]=anovan(X,{factor1 factor2 factor3},'random',3)  % perform three-way ANOVA

figure,
[comp,m] = multcompare(Stats,'ctype','scheffe','dimension',dim)  % post-hoc on the 2nd factor


